<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Week 10, Day 3: SHSAT Prep</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="lesson-container">
        <h1>Week 10, Day 3</h1>
        <div id="lesson-content"></div>
        <button id="next-btn" style="display: none;">Next</button>
        <div id="results-screen" style="display: none;">
            <h2>Lesson Complete!</h2>
            <p>Your score: <span id="score"></span></p>
            <p><span id="total-correct"></span> correct out of <span id="total-questions"></span></p>
            <a href="../index.html" class="home-btn">Back to Dashboard</a>
        </div>
    </div>

    <script>
        const lessonData = {
            title: "Week 10, Day 3",
            completed: false,
            questions: [
                { type: 'briefing', text: 'Day 3 of our final polish! Today, we\'ll tackle tricky punctuation like semicolons and colons, and practice solving systems of equations.' },
                { type: 'mcq', question: 'Choose the sentence with the correct punctuation.', options: [
                    'I need to buy: milk, eggs, and bread.',
                    'I need to buy the following: milk, eggs, and bread.',
                    'I need to buy; milk, eggs, and bread.',
                    'I need to buy, milk, eggs, and bread.'
                ], answer: 'I need to buy the following: milk, eggs, and bread.' },
                { type: 'mcq', question: 'If 2x + y = 10 and x - y = 2, what is the value of x?', options: ['2', '3', '4', '6'], answer: '4' },
                { type: 'mcq', question: 'Which sentence demonstrates correct use of a semicolon?', options: [
                    'I love reading; and I also love writing.',
                    'The weather was beautiful; so we went to the park.',
                    'She is an expert in marine biology; she has studied whales for years.',
                    'He brought the main course; she the dessert.'
                ], answer: 'She is an expert in marine biology; she has studied whales for years.' },
                { type: 'mcq', question: 'Solve for y in the system: 3x + 2y = 16 and x = 2y - 4.', options: ['y = 2', 'y = 3.5', 'y = 4', 'y = 5'], answer: 'y = 4' },
                { type: 'mcq', question: 'What is parallelism?', options: [
                    'Using the same word multiple times.',
                    'A sentence that has two parallel lines in it.',
                    'Using the same pattern of words to show that two or more ideas have the same level of importance.',
                    'Ending a sentence with a preposition.'
                ], answer: 'Using the same pattern of words to show that two or more ideas have the same level of importance.' },
                { type: 'mcq', question: 'A coffee shop sells two types of coffee. One costs $5 per pound and the other costs $7 per pound. If they want to create a 20-pound blend that costs $6.50 per pound, how many pounds of the $7 coffee should they use?', options: ['5 pounds', '10 pounds', '15 pounds', '20 pounds'], answer: '15 pounds' },
                { type: 'mcq', question: 'Which sentence is NOT parallel?', options: [
                    'He enjoys hiking, biking, and to swim.',
                    'She wanted to travel the world, to write a novel, and to start a family.',
                    'The cat ran across the yard, jumped over the fence, and disappeared into the bushes.',
                    'Reading a book is as enjoyable as watching a movie.'
                ], answer: 'He enjoys hiking, biking, and to swim.' },
                { type: 'mcq', question: 'The sum of two numbers is 24. Their difference is 6. What are the two numbers?', options: ['10 and 14', '9 and 15', '12 and 12', '8 and 16'], answer: '9 and 15' },
                { type: 'mcq', question: 'When should a colon be used?', options: [
                    'To separate two independent clauses.',
                    'Before a list of items, especially after an independent clause.',
                    'To indicate a pause longer than a comma but shorter than a period.',
                    'To join two related but contrasting ideas.'
                ], answer: 'Before a list of items, especially after an independent clause.' },
                { type: 'mcq', question: 'Tickets for a concert cost $10 for adults and $5 for children. If 300 tickets were sold for a total of $2,250, how many adult tickets were sold?', options: ['100', '150', '200', '250'], answer: '150' },
                { type: 'mcq', question: 'Correct the parallelism error: "The manager was asked to write his report quickly, accurately, and in a detailed manner."', options: [
                    'The manager was asked to write his report quickly, accurately, and detailedly.',
                    'The manager was asked to write his report quickly, with accuracy, and in a detailed manner.',
                    'The manager was asked to write his report in a quick, accurate, and detailed manner.',
                    'The manager was asked to write his report quickly, accurately, and thoroughly.'
                ], answer: 'The manager was asked to write his report quickly, accurately, and thoroughly.' },
                { type: 'mcq', question: 'What is the intersection point of the lines y = 2x + 1 and y = -x + 7?', options: ['(1, 3)', '(2, 5)', '(3, 4)', '(4, 3)'], answer: '(2, 5)' },
                { type: 'mcq', question: 'A semicolon can be used to connect two closely related __________.', options: ['dependent clauses', 'phrases', 'independent clauses', 'words'], answer: 'independent clauses' },
                { type: 'mcq', question: 'The word "ephemeral" is to "lasting" as "boisterous" is to __________.', options: ['loud', 'calm', 'happy', 'sad'], answer: 'calm' },
                { type: 'mcq', question: 'A farm has only chickens and pigs. There are 35 heads and 100 legs in total. How many chickens are on the farm?', options: ['15', '20', '25', '30'], answer: '20' },
                { type: 'mcq', question: 'Which is the best revision of the sentence: "The athlete was a great runner, a good swimmer, and he was also good at jumping."', options: [
                    'The athlete was a great runner, a good swimmer, and a great jumper.',
                    'The athlete was great at running, good at swimming, and also at jumping.',
                    'The athlete was a great runner, swimmer, and jumper.',
                    'The athlete ran great, swam good, and jumped great.'
                ], answer: 'The athlete was a great runner, a good swimmer, and a great jumper.' },
                { type: 'mcq', question: 'A store mixes nuts worth $1.50 per pound and nuts worth $2.00 per pound to make 10 pounds of a mixture worth $1.80 per pound. How many pounds of the $2.00 nuts are used?', options: ['4 pounds', '5 pounds', '6 pounds', '8 pounds'], answer: '6 pounds' },
                { type: 'mcq', question: 'Identify the error in the sentence: "The book had a compelling plot, characters that were interesting, and a style that was unique."', options: ['faulty parallelism', 'comma splice', 'dangling modifier', 'no error'], answer: 'faulty parallelism' },
                { type: 'mcq', question: 'If x + y = 8 and 2x - y = 1, what is x*y?', options: ['12', '15', '16', '18'], answer: '15' },
                { type: 'mcq', question: 'Choose the correct sentence: "She packed three things; a toothbrush, a book, and a map."', options: [
                    'She packed three things; a toothbrush, a book, and a map.',
                    'She packed three things: a toothbrush, a book, and a map.',
                    'She packed three things, a toothbrush, a book, and a map.',
                    'She packed three things a toothbrush, a book, and a map.'
                ], answer: 'She packed three things: a toothbrush, a book, and a map.' }
            ]
        };

        const lessonContent = document.getElementById('lesson-content');
        const nextBtn = document.getElementById('next-btn');
        const resultsScreen = document.getElementById('results-screen');
        const scoreEl = document.getElementById('score');
        const totalCorrectEl = document.getElementById('total-correct');
        const totalQuestionsEl = document.getElementById('total-questions');

        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let selectedAnswer = null;

        function showQuestion(index) {
            const questionData = lessonData.questions[index];
            lessonContent.innerHTML = '';
            selectedAnswer = null;

            if (questionData.type === 'briefing') {
                const briefingText = document.createElement('p');
                briefingText.textContent = questionData.text;
                lessonContent.appendChild(briefingText);
                nextBtn.textContent = 'Start Lesson';
            } else if (questionData.type === 'mcq') {
                const questionText = document.createElement('p');
                questionText.textContent = questionData.question;
                lessonContent.appendChild(questionText);

                const optionsList = document.createElement('ul');
                optionsList.className = 'mcq-options';
                questionData.options.forEach(option => {
                    const listItem = document.createElement('li');
                    listItem.textContent = option;
                    listItem.addEventListener('click', () => selectAnswer(listItem, option, questionData.answer));
                    optionsList.appendChild(listItem);
                });
                lessonContent.appendChild(optionsList);
                nextBtn.textContent = 'Next';
            } else if (questionData.type === 'scrambled_paragraph') {
                const instructionText = document.createElement('p');
                instructionText.textContent = 'Unscramble the following sentences to form a coherent paragraph. Drag and drop the sentences into the correct order.';
                lessonContent.appendChild(instructionText);

                const dropZone = document.createElement('div');
                dropZone.id = 'drop-zone';
                dropZone.className = 'scrambled-paragraph';

                const scrambledSentences = [...questionData.sentences].sort(() => Math.random() - 0.5);

                scrambledSentences.forEach((sentence, i) => {
                    const sentenceDiv = document.createElement('div');
                    sentenceDiv.textContent = sentence;
                    sentenceDiv.className = 'draggable';
                    sentenceDiv.draggable = true;
                    sentenceDiv.id = `sentence-${i}`;
                    sentenceDiv.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', e.target.id);
                    });
                    dropZone.appendChild(sentenceDiv);
                });

                lessonContent.appendChild(dropZone);

                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                });

                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const id = e.dataTransfer.getData('text/plain');
                    const draggableElement = document.getElementById(id);
                    const dropZone = e.target.closest('#drop-zone');
                    if (dropZone) {
                        const allDraggables = [...dropZone.querySelectorAll('.draggable')];
                        const hoverElement = allDraggables.find(child => {
                             const box = child.getBoundingClientRect();
                             return e.clientY < box.top + box.height / 2;
                        });
                        if(hoverElement) {
                            dropZone.insertBefore(draggableElement, hoverElement);
                        } else {
                            dropZone.appendChild(draggableElement);
                        }
                    }
                });
                 nextBtn.textContent = 'Submit Order';
            }
            
            nextBtn.style.display = 'block';
            if (questionData.type === 'mcq') {
                 nextBtn.disabled = true;
            } else {
                nextBtn.disabled = false;
            }
        }

        function selectAnswer(element, selected, correct) {
            const options = document.querySelectorAll('.mcq-options li');
            options.forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                opt.style.pointerEvents = 'none'; 
            });

            element.classList.add('selected');
            selectedAnswer = selected;
            
            if (selected === correct) {
                element.classList.add('correct');
                correctAnswers++;
            } else {
                element.classList.add('incorrect');
                options.forEach(opt => {
                    if (opt.textContent === correct) {
                        opt.classList.add('correct');
                    }
                });
            }
            nextBtn.disabled = false;
        }
        
        function handleScrambledParagraph() {
            const dropZone = document.getElementById('drop-zone');
            const userOrder = [...dropZone.querySelectorAll('.draggable')].map(div => div.textContent);
            const correctOrder = lessonData.questions[currentQuestionIndex].sentences;
            
            let isCorrect = true;
            for(let i=0; i < correctOrder.length; i++) {
                if(userOrder[i] !== correctOrder[i]) {
                    isCorrect = false;
                    break;
                }
            }

            if(isCorrect) {
                correctAnswers++;
                dropZone.style.border = '2px solid green';
            } else {
                dropZone.style.border = '2px solid red';
            }
            
            [...dropZone.querySelectorAll('.draggable')].forEach(el => el.draggable = false);

        }

        function showResults() {
            lessonContent.style.display = 'none';
            nextBtn.style.display = 'none';
            resultsScreen.style.display = 'block';
            
            const total = lessonData.questions.filter(q => q.type !== 'briefing').length;
            const score = total > 0 ? Math.round((correctAnswers / total) * 100) : 100;

            scoreEl.textContent = `${score}%`;
            totalCorrectEl.textContent = correctAnswers;
            totalQuestionsEl.textContent = total;

            const storageKey = `lessonStatus_${lessonData.title.replace(/\s+/g, '_')}`;
            localStorage.setItem(storageKey, 'Completed');
        }

        nextBtn.addEventListener('click', () => {
            const questionData = lessonData.questions[currentQuestionIndex];

            if (questionData.type === 'scrambled_paragraph') {
                handleScrambledParagraph();
                 setTimeout(() => {
                    currentQuestionIndex++;
                    loadNext();
                }, 1500); 
                return; 
            }
            
            if (questionData.type === 'mcq' && selectedAnswer === null) {
                return;
            }


            currentQuestionIndex++;
            loadNext();
        });

        function loadNext() {
             if (currentQuestionIndex < lessonData.questions.length) {
                showQuestion(currentQuestionIndex);
            } else {
                showResults();
            }
        }

        showQuestion(currentQuestionIndex);
    </script>
</body>
</html>