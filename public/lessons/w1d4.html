<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>W1D4: Clarity & Percentages</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="container">
        <header id="lesson-header"></header>
        <div id="lesson-deck"></div>
        <div id="results-screen" style="display: none;"></div>
    </div>

    <script>
        const lessonData = {
            title: "Mission: Clarity & Percentages",
            subtitle: "Week 1, Day 4",
            pointsPerQuestion: 10,
            steps: [
                {
                    type: 'briefing',
                    header: 'Briefing: Precision and Parts',
                    content: `
                        <p>Today's targets are precision and parts of a whole. For ELA, we're honing <strong>Revising/Editing</strong> skills, focusing on making sentences clear and concise. For Math, we're mastering <strong>Percentages</strong>.</p>
                        <ul>
                            <li><strong>Clarity & Conciseness:</strong> Good writing is direct. Eliminate redundant words and phrases that say the same thing twice (e.g., "twelve noon" is just "noon").</li>
                            <li><strong>Percentages:</strong> A percentage is just a special fraction where the denominator is always 100. To find a percentage of a number, convert the percent to a decimal or fraction and multiply.</li>
                        </ul>
                    `
                },
                // ELA Questions: Revising/Editing for Clarity and Conciseness
                {
                    type: 'mcq',
                    header: 'ELA Challenge 1: Redundancy',
                    prompt: 'Choose the best revision for the sentence.',
                    passage: 'The reason the team won was because they had practiced a great deal in advance beforehand.',
                    options: [
                        'The reason the team won was because they practiced a great deal.',
                        'The team won because they had practiced a great deal beforehand.',
                        'The team won because they practiced a great deal.',
                        'The winning team won because of a great deal of practice.'
                    ],
                    correctAnswer: 'The team won because they practiced a great deal.',
                    explanation: 'This is the most concise and direct option. "The reason...was because" is redundant. "In advance" and "beforehand" mean the same thing.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Challenge 2: Wordiness',
                    prompt: 'Which of the following sentences is the most concise?',
                    passage: '',
                    options: [
                        'She was happy and glad to accept the award that was given to her.',
                        'She was happy to accept the award.',
                        'It was with happiness that she accepted the award.',
                        'The award, which she accepted, made her glad and happy.'
                    ],
                    correctAnswer: 'She was happy to accept the award.',
                    explanation: '"Happy" and "glad" are synonyms, so you only need one. The other options add unnecessary words.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Challenge 3: Combining Sentences',
                    prompt: 'Which is the best way to combine the two sentences?',
                    passage: 'The artist was famous. Her paintings sold for millions.',
                    options: [
                        'The artist was famous, and her paintings sold for millions.',
                        "The famous artist's paintings sold for millions.",
                        'The artist was famous, so her paintings sold for millions.',
                        'Her paintings sold for millions, and she was a famous artist.'
                    ],
                    correctAnswer: "The famous artist's paintings sold for millions.",
                    explanation: 'This option concisely combines the two ideas by using "famous" as an adjective directly describing the artist.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Challenge 4: Passive Voice',
                    prompt: 'Choose the most direct and active revision.',
                    passage: 'The ball was hit by the boy.',
                    options: [
                        'The ball was hit by the boy, and it went far.',
                        'The boy hit the ball.',
                        'Hitting the ball was what the boy did.',
                        'It was the boy who hit the ball.'
                    ],
                    correctAnswer: 'The boy hit the ball.',
                    explanation: 'This sentence uses the active voice (Subject-Verb-Object), which is more direct and concise than the passive voice.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Challenge 5: Redundancy',
                    prompt: 'Choose the best revision for the sentence.',
                    passage: 'The final outcome of the experiment was a surprise to everyone.',
                    options: [
                        'The final outcome of the experiment surprised all the people.',
                        'The outcome of the experiment was a surprise to everyone.',
                        'The final result of the experiment was a surprise.',
                        "The experiment's outcome was a final surprise."
                    ],
                    correctAnswer: 'The outcome of the experiment was a surprise to everyone.',
                    explanation: '"Final outcome" is redundant because an outcome is inherently final. Removing "final" makes the sentence more concise.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Challenge 6: Wordiness',
                    prompt: 'Which sentence is the most concise?',
                    passage: '',
                    options: [
                        'At this point in time, we should probably go ahead and get started.',
                        'It is time for us to begin now.',
                        'We should begin.',
                        'The time is now for us to make a start.'
                    ],
                    correctAnswer: 'We should begin.',
                    explanation: 'This option cuts out all the filler words like "At this point in time" and "go ahead and" to state the idea directly.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Challenge 7: Clarity',
                    prompt: 'Choose the clearest revision.',
                    passage: 'After mixing the chemicals, the solution turned blue, which was interesting.',
                    options: [
                        'The solution turned blue after mixing the chemicals, and it was interesting.',
                        'It was interesting that the solution turned blue after mixing the chemicals.',
                        'The chemist found it interesting that the solution turned blue after the chemicals were mixed.',
                        'The interesting solution turned blue after mixing the chemicals.'
                    ],
                    correctAnswer: 'The chemist found it interesting that the solution turned blue after the chemicals were mixed.',
                    explanation: 'The original sentence has a vague "which". This revision clarifies who found the result interesting (the chemist).'
                },
                {
                    type: 'mcq',
                    header: 'ELA Challenge 8: Combining Sentences',
                    prompt: 'Which is the best way to combine the sentences?',
                    passage: 'The cat is old. It sleeps most of the day. Its name is Sam.',
                    options: [
                        'The old cat, Sam, sleeps most of the day.',
                        "Sam is the cat's name, and it is old and sleeps most of the day.",
                        'The cat is old, its name is Sam, and it sleeps most of the day.',
                        'Sleeping most of the day, the old cat is named Sam.'
                    ],
                    correctAnswer: 'The old cat, Sam, sleeps most of the day.',
                    explanation: 'This option uses an appositive phrase ("Sam") and an adjective ("old") to combine all the information smoothly and concisely.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Challenge 9: Redundancy',
                    prompt: 'Choose the best revision for the sentence.',
                    passage: 'Each and every student is required to attend the assembly.',
                    options: [
                        'Each student is required to attend the assembly.',
                        'Every single student is required to attend.',
                        'Attendance at the assembly is required for each and every student.',
                        'The students are all required to attend the assembly.'
                    ],
                    correctAnswer: 'Each student is required to attend the assembly.',
                    explanation: '"Each" and "every" mean the same thing in this context, so using both is redundant. "Each student" is sufficient.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Challenge 10: Wordiness',
                    prompt: 'Which sentence is the most concise?',
                    passage: '',
                    options: [
                        'The decision that she made was to study biology.',
                        'Her decision was to make a study of biology.',
                        'She made a decision, and that decision was to study biology.',
                        'She decided to study biology.'
                    ],
                    correctAnswer: 'She decided to study biology.',
                    explanation: 'This option uses the strong verb "decided" and avoids the clunky phrase "The decision that she made was...".'
                },

                // Math Questions: Percentages
                {
                    type: 'grid-in',
                    header: 'Math Challenge 1: Basic Percentage',
                    prompt: 'What is 35% of 80?',
                    passage: '',
                    correctAnswer: '28',
                    explanation: 'Convert 35% to a decimal (0.35) and multiply by 80.  0.35 * 80 = 28.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Challenge 2: Percent Discount',
                    prompt: 'A shirt originally costing $50 is on sale for 20% off. What is the new price in dollars?',
                    passage: '',
                    correctAnswer: '40',
                    explanation: 'First, find the discount amount: 20% of $50 is (0.20 * 50) = $10. Then, subtract the discount from the original price: $50 - $10 = $40.'
                },
                {
                    type: 'mcq',
                    header: 'Math Challenge 3: Percent Increase',
                    prompt: 'A population of bacteria increases from 200 to 250. What is the percent increase?',
                    passage: '',
                    options: ['20%', '25%', '50%', '125%'],
                    correctAnswer: '25%',
                    explanation: 'The formula for percent increase is [(New Value - Original Value) / Original Value] * 100. The increase is 250 - 200 = 50. So, (50 / 200) * 100 = (1/4) * 100 = 25%.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Challenge 4: Finding the Whole',
                    prompt: '12 is 30% of what number?',
                    passage: '',
                    correctAnswer: '40',
                    explanation: 'Set up the equation: 0.30 * x = 12. To solve for x, divide both sides by 0.30. x = 12 / 0.30 = 40.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Challenge 5: Sales Tax',
                    prompt: 'A video game costs $60. If the sales tax is 8%, what is the total cost in dollars?',
                    passage: '',
                    correctAnswer: '64.80',
                    explanation: 'First, calculate the tax amount: 8% of $60 is (0.08 * 60) = $4.80. Then, add the tax to the original price: $60 + $4.80 = $64.80.'
                },
                {
                    type: 'mcq',
                    header: 'Math Challenge 6: Multi-step Percentage',
                    prompt: 'A store buys a jacket for $80. They mark it up by 50%. Then, they sell it at a 20% discount off the marked-up price. What is the final selling price?',
                    passage: '',
                    options: ['$96', '$88', '$100', '$120'],
                    correctAnswer: '$96',
                    explanation: 'First, find the marked-up price: $80 * 1.50 = $120. Then, find the discount amount on the new price: 20% of $120 is (0.20 * 120) = $24. Finally, subtract the discount: $120 - $24 = $96.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Challenge 7: Percent of a Percent',
                    prompt: 'What is 50% of 20% of 300?',
                    passage: '',
                    correctAnswer: '30',
                    explanation: 'Convert percentages to decimals and multiply: 0.50 * 0.20 * 300 = 0.10 * 300 = 30.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Challenge 8: Reverse Percentage',
                    prompt: 'After a 15% discount, a phone costs $340. What was its original price?',
                    passage: '',
                    correctAnswer: '400',
                    explanation: 'If the phone was discounted by 15%, the current price is 100% - 15% = 85% of the original price. Set up the equation: 0.85 * x = 340. Solve for x: x = 340 / 0.85 = 400. The original price was $400.'
                },
                {
                    type: 'mcq',
                    header: 'Math Challenge 9: Commission',
                    prompt: 'A salesperson earns a 5% commission on their sales. If they sell a car for $22,000, how much commission do they earn?',
                    passage: '',
                    options: ['$1,100', '$1,000', '$2,200', '$550'],
                    correctAnswer: '$1,100',
                    explanation: 'Calculate 5% of $22,000. Convert 5% to a decimal (0.05) and multiply: 0.05 * 22000 = 1100. The commission is $1,100.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Challenge 10: Tipping',
                    prompt: 'Your restaurant bill is $75. You want to leave a 20% tip. What is the total amount you will pay?',
                    passage: '',
                    correctAnswer: '90',
                    explanation: 'Calculate the tip amount: 20% of $75 is (0.20 * 75) = $15. Add the tip to the bill: $75 + $15 = $90.'
                }
            ]
        };

        // --- Core Lesson Engine ---
        document.addEventListener('DOMContentLoaded', () => {
            const header = document.getElementById('lesson-header');
            const deck = document.getElementById('lesson-deck');
            const resultsScreen = document.getElementById('results-screen');
            const lessonId = window.location.pathname.split('/').pop();

            let currentStep = 0;
            let score = 0;
            let questionSteps = lessonData.steps.filter(s => s.type !== 'briefing');

            function init() {
                header.innerHTML = `<h1>${lessonData.title}</h1><h2>${lessonData.subtitle}</h2>`;
                renderStep();
            }

            function renderStep() {
                deck.innerHTML = '';
                if (currentStep >= lessonData.steps.length) {
                    showResults();
                    return;
                }

                const step = lessonData.steps[currentStep];
                const card = document.createElement('div');
                card.className = `card ${step.type}-card`;

                let content = `<h3>${step.header}</h3>`;
                if (step.passage) content += `<p class="passage">${step.passage}</p>`;
                if (step.prompt) content += `<p class="prompt">${step.prompt}</p>`;

                if (step.type === 'briefing') {
                    content += `<div class="briefing-content">${step.content}</div>`;
                    content += `<button id="next-btn">Start</button>`;
                } else if (step.type === 'mcq') {
                    content += '<div class="options">';
                    step.options.forEach(opt => {
                        content += `<button class="option">${opt}</button>`;
                    });
                    content += '</div>';
                } else if (step.type === 'grid-in') {
                    content += `<input type="text" id="grid-in-answer" placeholder="Enter your answer">`;
                    content += `<button id="submit-btn">Submit</button>`;
                } else if (step.type === 'scrambled-paragraph') {
                    // New logic for scrambled-paragraph will go here
                    // For now, let's just show the sentences and options
                    const sentenceContainer = document.createElement('div');
                    step.sentences.forEach(s => {
                        const p = document.createElement('p');
                        p.textContent = `(${s.id}) ${s.text}`;
                        sentenceContainer.appendChild(p);
                    });
                    content += sentenceContainer.innerHTML;
                    
                    content += '<div class="options">';
                    step.options.forEach(opt => {
                        content += `<button class="option">${opt}</button>`;
                    });
                    content += '</div>';
                }
                card.innerHTML = content;
                deck.appendChild(card);
                addEventListeners();
            }

            function addEventListeners() {
                const step = lessonData.steps[currentStep];
                 if (step.type === 'briefing') {
                    document.getElementById('next-btn').addEventListener('click', () => {
                        currentStep++;
                        renderStep();
                    });
                } else if (step.type === 'mcq' || step.type === 'scrambled-paragraph') {
                    document.querySelectorAll('.option').forEach(btn => {
                        btn.addEventListener('click', (e) => checkMCQAnswer(e.target));
                    });
                } else if (step.type === 'grid-in') {
                    document.getElementById('submit-btn').addEventListener('click', checkGridInAnswer);
                }
            }

            function checkMCQAnswer(selectedButton) {
                const step = lessonData.steps[currentStep];
                const isCorrect = selectedButton.textContent === step.correctAnswer;
                revealAnswer(isCorrect, step.explanation, selectedButton);
            }

            function checkGridInAnswer() {
                const step = lessonData.steps[currentStep];
                const answer = document.getElementById('grid-in-answer').value;
                const isCorrect = answer.trim().toLowerCase() === step.correctAnswer.toLowerCase();
                 revealAnswer(isCorrect, step.explanation);
            }

            function revealAnswer(isCorrect, explanation, selectedButton = null) {
                const step = lessonData.steps[currentStep];
                if (isCorrect) {
                    score += lessonData.pointsPerQuestion;
                    if (selectedButton) {
                        selectedButton.classList.add('correct');
                    } else {
                         document.getElementById('grid-in-answer').classList.add('correct');
                    }
                } else {
                    if (selectedButton) {
                        selectedButton.classList.add('incorrect');
                        // Highlight the correct answer
                        document.querySelectorAll('.option').forEach(btn => {
                            if (btn.textContent === step.correctAnswer) {
                                btn.classList.add('correct');
                            }
                        });
                    } else {
                        document.getElementById('grid-in-answer').classList.add('incorrect');
                    }
                }

                // Disable all inputs
                document.querySelectorAll('.option, #submit-btn, #grid-in-answer').forEach(el => el.disabled = true);

                // Show explanation
                const explanationEl = document.createElement('div');
                explanationEl.className = 'explanation';
                explanationEl.innerHTML = `<p>${explanation}</p><button id="next-btn">Next</button>`;
                deck.querySelector('.card').appendChild(explanationEl);

                // Add event listener to the new "Next" button
                document.getElementById('next-btn').addEventListener('click', () => {
                    currentStep++;
                    renderStep();
                });
            }

            function showResults() {
                deck.style.display = 'none';
                resultsScreen.style.display = 'block';
                const finalScore = score;
                const totalPossible = questionSteps.length * lessonData.pointsPerQuestion;

                resultsScreen.innerHTML = `
                    <h2>Mission Complete!</h2>
                    <p>Your Score: ${finalScore} / ${totalPossible}</p>
                    <p>You answered ${finalScore / lessonData.pointsPerQuestion} out of ${questionSteps.length} questions correctly.</p>
                    <button onclick="window.location.href='../index.html'">Return to Dashboard</button>
                `;
                
                // Mark lesson as complete
                localStorage.setItem(lessonId, 'completed');
            }

            init();
        });
    </script>
</body>
</html> 