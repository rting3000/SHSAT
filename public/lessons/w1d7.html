<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>W1D7: Weekly Review</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="container">
        <header id="lesson-header"></header>
        <div id="lesson-deck"></div>
        <div id="results-screen" style="display: none;"></div>
    </div>

    <script>
        const lessonData = {
            title: "Week 1 Comprehensive Review",
            subtitle: "Day 7: Test Your Knowledge",
            pointsPerQuestion: 10,
            steps: [
                {
                    type: 'briefing',
                    header: 'Briefing: Week 1 Gauntlet',
                    content: `
                        <p>Welcome to your first weekly review. This is a comprehensive test of everything you've learned in Week 1, from ELA concepts like main idea and paragraph structure to Math fundamentals like ratios, rates, and percentages.</p>
                        <p>There are 30 questions in this review. Take your time, read carefully, and show what you've learned. Good luck!</p>
                    `
                },
                // Question 1: Main Idea
                {
                    type: 'mcq',
                    header: 'Review 1: Main Idea',
                    passage: 'The Roman road network was one of the empire\'s greatest achievements. Spanning over 50,000 miles, these roads were expertly engineered with layers of crushed stone and pavers. They facilitated the rapid movement of troops, trade goods, and communication, effectively binding the vast empire together.',
                    prompt: 'The central idea of this passage is that the Roman road network was:',
                    options: [
                        'Impressively long.',
                        'An engineering marvel crucial to the empire\'s cohesion.',
                        'Primarily used for trade.',
                        'Built with crushed stone.'
                    ],
                    correctAnswer: 'An engineering marvel crucial to the empire\'s cohesion.',
                    explanation: 'This choice best summarizes the passage by including both the engineering aspect and the vital function of the roads in unifying the empire.'
                },
                // Question 2: Averages
                {
                    type: 'grid-in',
                    header: 'Review 2: Averages',
                    prompt: 'The average of five numbers is 20. If four of the numbers are 15, 18, 22, and 25, what is the fifth number?',
                    correctAnswer: '20',
                    explanation: 'If the average of five numbers is 20, their sum must be 5 * 20 = 100. The sum of the four given numbers is 15 + 18 + 22 + 25 = 80. Therefore, the fifth number must be 100 - 80 = 20.'
                },
                // Question 3: Scrambled Paragraph
                {
                    type: 'scrambled-paragraph',
                    header: 'Review 3: Scrambled Paragraph',
                    prompt: 'Choose the most logical order for the sentences.',
                    sentences: [
                        { id: 'A', 'text': 'This process allows them to convert sunlight into glucose, their food source.' },
                        { id: 'B', 'text': 'Photosynthesis is the fundamental process by which plants create energy.' },
                        { id: 'C', 'text': 'It requires sunlight, water, and carbon dioxide.' },
                        { id: 'D', 'text': 'As a byproduct, it releases the oxygen that most animal life depends on to breathe.' }
                    ],
                    options: ['B, C, A, D', 'A, B, C, D', 'B, A, D, C', 'C, D, B, A'],
                    correctAnswer: 'B, C, A, D',
                    explanation: 'B introduces the topic (photosynthesis). C lists the necessary ingredients. A explains what the process achieves for the plant. D explains its crucial byproduct for others.'
                },
                // Question 4: Percentages
                {
                    type: 'grid-in',
                    header: 'Review 4: Percentages',
                    prompt: 'A city has a population of 200,000. If the population increases by 5%, what is the new population?',
                    correctAnswer: '210000',
                    explanation: 'The increase is 5% of 200,000, which is 0.05 * 200,000 = 10,000. The new population is 200,000 + 10,000 = 210,000.'
                },
                // Question 5: Author's Purpose
                {
                    type: 'mcq',
                    header: 'Review 5: Author\'s Purpose',
                    passage: 'The old lighthouse has stood watch over these shores for two centuries. It has guided countless ships through treacherous storms and is a beloved symbol of our town\'s maritime heritage. Now, it faces demolition due to budget cuts. We must not let this piece of our history vanish.',
                    prompt: 'The author\'s main purpose is to:',
                    options: [
                        'Explain how lighthouses work.',
                        'Persuade readers to save the historic lighthouse.',
                        'Tell a fictional story about a lighthouse keeper.',
                        'Analyze the town budget.'
                    ],
                    correctAnswer: 'Persuade readers to save the historic lighthouse.',
                    explanation: 'The passage highlights the lighthouse\'s historical and emotional value and ends with a direct plea ("We must not let..."), indicating a persuasive intent.'
                },
                // Question 6: Ratios
                {
                    type: 'grid-in',
                    header: 'Review 6: Ratios',
                    prompt: 'In a fruit basket, the ratio of apples to oranges is 4:5. If there are 36 fruits in total, how many are oranges?',
                    correctAnswer: '20',
                    explanation: 'The total number of ratio parts is 4 + 5 = 9. Divide the total fruits by the total parts: 36 / 9 = 4 fruits per part. Oranges account for 5 parts, so 5 * 4 = 20 oranges.'
                },
                // Question 7: Inference
                {
                    type: 'mcq',
                    header: 'Review 7: Inference',
                    passage: 'When the power went out, Maria didn\'t panic. She calmly located a flashlight, checked on her younger brother, and then lit the candles she kept for just such an occasion. She spent the rest of the evening reading a book.',
                    prompt: 'What can one infer about Maria?',
                    options: [
                        'She dislikes electricity.',
                        'She is resourceful and composed.',
                        'She caused the power outage.',
                        'She was scared of the dark.'
                    ],
                    correctAnswer: 'She is resourceful and composed.',
                    explanation: 'Her calm, logical actions (finding a flashlight, lighting candles) show that she is composed and well-prepared, indicating resourcefulness.'
                },
                // Question 8: Probability
                {
                    type: 'mcq',
                    header: 'Review 8: Probability',
                    prompt: 'A standard six-sided die is rolled. What is the probability of rolling a number greater than 4?',
                    options: ['1/6', '1/3', '1/2', '2/3'],
                    correctAnswer: '1/3',
                    explanation: 'The numbers greater than 4 on a six-sided die are 5 and 6. That is 2 favorable outcomes out of 6 possible outcomes. The probability is 2/6, which simplifies to 1/3.'
                },
                // Question 9: Revising/Editing
                {
                    type: 'mcq',
                    header: 'Review 9: Revising/Editing',
                    prompt: 'Which choice is the best way to write the underlined part of the sentence? "The reason I was late is because the traffic was heavy."',
                    options: [
                        'is because the traffic was heavy.',
                        'was because the traffic was heavy.',
                        'is that the traffic was heavy.',
                        'is since the traffic was heavy.'
                    ],
                    correctAnswer: 'is that the traffic was heavy.',
                    explanation: 'The phrase "The reason is because" is redundant. The correct and more concise phrasing is "The reason is that..."'
                },
                // Question 10: Proportions
                {
                    type: 'grid-in',
                    header: 'Review 10: Proportions',
                    prompt: 'A recipe for 4 people calls for 2 cups of rice. How much rice is needed if you are cooking for 10 people?',
                    correctAnswer: '5',
                    explanation: 'Set up a proportion: 2 cups / 4 people = x cups / 10 people. The unit rate is 0.5 cups per person. For 10 people, you would need 10 * 0.5 = 5 cups.'
                },
                // Question 11
                {
                    type: 'mcq',
                    header: 'Review 11: Punctuation',
                    prompt: 'Which sentence is punctuated correctly?',
                    options: [
                        "The teams captain, was a great leader.",
                        "The team's captain was a great leader.",
                        "The teams' captain was a great leader.",
                        "The team captain was a great leader."
                    ],
                    correctAnswer: "The team's captain was a great leader.",
                    explanation: 'The possessive form for a singular noun ("team") is formed by adding an apostrophe and "s".'
                },
                // Question 12
                {
                    type: 'grid-in',
                    header: 'Review 12: Rate Problem',
                    prompt: 'A car travels at 60 miles per hour. How many miles will it travel in 2.5 hours?',
                    correctAnswer: '150',
                    explanation: 'Distance = Speed × Time. So, 60 mph * 2.5 hours = 150 miles.'
                },
                // Question 13
                {
                    type: 'mcq',
                    header: 'Review 13: Vocabulary',
                    prompt: 'Choose the word that is most nearly opposite in meaning to "mitigate".',
                    options: ['Alleviate', 'Intensify', 'Soothe', 'Reduce'],
                    correctAnswer: 'Intensify',
                    explanation: '"Mitigate" means to make something less severe or painful. "Intensify" is the opposite.'
                },
                // Question 14
                {
                    type: 'grid-in',
                    header: 'Review 14: Solving for x',
                    prompt: 'If 3x + 5 = 20, what is the value of x?',
                    correctAnswer: '5',
                    explanation: 'Subtract 5 from both sides: 3x = 15. Then, divide by 3: x = 5.'
                },
                // Question 15
                {
                    type: 'mcq',
                    header: 'Review 15: Logical Reasoning',
                    passage: 'All students in the music program must attend the concert. Sarah is in the music program. Therefore, ______.',
                    prompt: 'Which statement best completes the paragraph?',
                    options: [
                        'Sarah might go to the concert.',
                        'Sarah must go to the concert.',
                        'Sarah does not like concerts.',
                        'The concert is for music students.'
                    ],
                    correctAnswer: 'Sarah must go to the concert.',
                    explanation: 'The first sentence sets a rule for all members. The second sentence confirms Sarah is a member. The logical conclusion is that the rule applies to her.'
                },
                // Question 16
                {
                    type: 'grid-in',
                    header: 'Review 16: Geometry',
                    prompt: 'A rectangle has a length of 12 cm and a width of 8 cm. What is its area in square cm?',
                    correctAnswer: '96',
                    explanation: 'The area of a rectangle is length × width. So, 12 cm * 8 cm = 96 cm².'
                },
                // Question 17
                {
                    type: 'mcq',
                    header: 'Review 17: Sentence Fragment',
                    prompt: 'Which of the following is a sentence fragment?',
                    options: [
                        'The sun rises.',
                        'Although she felt tired.',
                        'Go to the store.',
                        'The cat slept.'
                    ],
                    correctAnswer: 'Although she felt tired.',
                    explanation: 'This is a dependent clause. It has a subject and a verb, but it cannot stand alone as a complete thought.'
                },
                // Question 18
                {
                    type: 'grid-in',
                    header: 'Review 18: Order of Operations',
                    prompt: 'What is the value of 10 - 2 * (3 + 1)?',
                    correctAnswer: '2',
                    explanation: 'Follow PEMDAS. Parentheses first: (3 + 1) = 4. Then multiplication: 2 * 4 = 8. Finally, subtraction: 10 - 8 = 2.'
                },
                // Question 19
                {
                    type: 'mcq',
                    header: 'Review 19: Paragraph Organization',
                    prompt: 'Which sentence does not belong in the paragraph?',
                    passage: '(1) The sun provides the energy for almost all life on Earth. (2) Plants use sunlight to create food through photosynthesis. (3) The sun is a star, a massive ball of hot gas. (4) Animals then get energy by eating plants or other animals. (5) This flow of energy is crucial for ecosystems.',
                    options: ['Sentence 2', 'Sentence 3', 'Sentence 4', 'Sentence 5'],
                    correctAnswer: 'Sentence 3',
                    explanation: 'The paragraph is about the flow of energy from the sun through ecosystems. Sentence 3, which describes what the sun is made of, is a detail that distracts from this main idea.'
                },
                // Question 20
                {
                    type: 'grid-in',
                    header: 'Review 20: Probability',
                    prompt: 'A bag contains 3 red marbles and 2 blue marbles. What is the probability of drawing a red marble?',
                    passage: 'Express your answer as a percentage.',
                    correctAnswer: '60',
                    explanation: 'There are 3 red marbles and a total of 5 marbles (3 + 2). The probability is 3/5, which is equal to 60%.'
                },
                {
                    type: 'mcq',
                    header: 'Review 21: Figurative Language',
                    prompt: 'The phrase "as busy as a bee" is an example of what?',
                    options: [
                        'A metaphor',
                        'A simile',
                        'Personification',
                        'Alliteration'
                    ],
                    correctAnswer: 'A simile',
                    explanation: 'This is a simile because it uses the word "as" to compare two different things (a person\'s business and a bee).'
                },
                {
                    type: 'grid-in',
                    header: 'Review 22: Multi-Step Percentages',
                    prompt: 'A coat is priced at $150. It is first discounted by 20%, and then a 10% sales tax is applied to the discounted price. What is the final cost?',
                    correctAnswer: '132',
                    explanation: 'First, calculate the discount: 20% of $150 is $30. The discounted price is $150 - $30 = $120. Then, calculate the sales tax: 10% of $120 is $12. The final cost is $120 + $12 = $132.'
                },
                {
                    type: 'mcq',
                    header: 'Review 23: Point of View',
                    prompt: 'A story told using "you" and "your" pronouns, making the reader a character in the story, is written in which point of view?',
                    options: [
                        'First-person',
                        'Second-person',
                        'Third-person limited',
                        'Third-person omniscient'
                    ],
                    correctAnswer: 'Second-person',
                    explanation: 'The second-person point of view directly addresses the reader using "you," which is rare in fiction but common in instructions and advertisements.'
                },
                {
                    type: 'grid-in',
                    header: 'Review 24: Fractions & Decimals',
                    prompt: 'What is 3/8 expressed as a decimal?',
                    correctAnswer: '0.375',
                    explanation: 'To convert a fraction to a decimal, divide the numerator by the denominator: 3 ÷ 8 = 0.375.'
                },
                {
                    type: 'mcq',
                    header: 'Review 25: Tone',
                    prompt: 'What is the most likely tone of a scientific research paper?',
                    options: [
                        'Humorous',
                        'Sarcastic',
                        'Objective',
                        'Sentimental'
                    ],
                    correctAnswer: 'Objective',
                    explanation: 'Scientific writing aims to be factual, unbiased, and based on evidence, which corresponds to an objective tone.'
                },
                {
                    type: 'grid-in',
                    header: 'Review 26: Equation with Parentheses',
                    prompt: 'Solve for y: 5(y - 3) = 3(y + 1)',
                    correctAnswer: '9',
                    explanation: 'Distribute on both sides: 5y - 15 = 3y + 3. Subtract 3y from both sides: 2y - 15 = 3. Add 15 to both sides: 2y = 18. Divide by 2: y = 9.'
                },
                {
                    type: 'mcq',
                    header: 'Review 27: Conciseness',
                    prompt: 'Which of the following is the most concise way to say "in spite of the fact that"?',
                    options: [
                        'Despite',
                        'Because of the fact that',
                        'Regardless of the fact that',
                        'Considering the fact that'
                    ],
                    correctAnswer: 'Despite',
                    explanation: '"Despite" or "although" are concise alternatives to the wordy phrase "in spite of the fact that."'
                },
                {
                    type: 'grid-in',
                    header: 'Review 28: Mixed Number Operations',
                    prompt: 'Calculate: 3 1/2 + 2 1/4',
                    passage: 'Express your answer as a mixed number (e.g., 5 3/4).',
                    correctAnswer: '5 3/4',
                    explanation: 'Convert to improper fractions: 7/2 + 9/4. Find a common denominator: 14/4 + 9/4. Add them: 23/4. Convert back to a mixed number: 23 divided by 4 is 5 with a remainder of 3, so 5 3/4.'
                },
                {
                    type: 'mcq',
                    header: 'Review 29: Verb Tense',
                    prompt: 'Which sentence uses the correct verb tense?',
                    options: [
                        'Yesterday, I have went to the park.',
                        'Yesterday, I go to the park.',
                        'Yesterday, I gone to the park.',
                        'Yesterday, I went to the park.'
                    ],
                    correctAnswer: 'Yesterday, I went to the park.',
                    explanation: 'The adverb "yesterday" requires the simple past tense, which is "went."'
                },
                {
                    type: 'grid-in',
                    header: 'Review 30: Final Challenge',
                    prompt: 'A library has 1,200 books. 40% are fiction, and the rest are non-fiction. Of the non-fiction books, 25% are biographies. How many biographies are in the library?',
                    correctAnswer: '180',
                    explanation: 'First, find the number of non-fiction books. If 40% are fiction, then 60% are non-fiction. 0.60 * 1200 = 720 non-fiction books. Now, find 25% of that number: 0.25 * 720 = 180 biographies.'
                }
            ]
        };

        // --- Core Lesson Engine ---
        document.addEventListener('DOMContentLoaded', () => {
            const header = document.getElementById('lesson-header');
            const deck = document.getElementById('lesson-deck');
            const resultsScreen = document.getElementById('results-screen');
            const lessonId = window.location.pathname.split('/').pop();

            let currentStep = 0;
            let score = 0;
            let questionSteps = lessonData.steps.filter(s => s.type !== 'briefing');

            function init() {
                header.innerHTML = `<h1>${lessonData.title}</h1><h2>${lessonData.subtitle}</h2>`;
                renderStep();
            }

            function renderStep() {
                deck.innerHTML = '';
                if (currentStep >= lessonData.steps.length) {
                    showResults();
                    return;
                }

                const step = lessonData.steps[currentStep];
                const card = document.createElement('div');
                card.className = `card ${step.type}-card`;

                let content = `<h3>${step.header}</h3>`;
                if (step.passage) content += `<p class="passage">${step.passage}</p>`;
                if (step.prompt) content += `<p class="prompt">${step.prompt}</p>`;

                if (step.type === 'briefing') {
                    content += `<div class="briefing-content">${step.content}</div>`;
                    content += `<button id="next-btn">Start</button>`;
                } else if (step.type === 'mcq' || step.type === 'scrambled-paragraph') {
                    content += '<div class="options">';
                    step.options.forEach(opt => {
                        content += `<button class="option">${opt}</button>`;
                    });
                    content += '</div>';
                } else if (step.type === 'grid-in') {
                    content += `<input type="text" id="grid-in-answer" placeholder="Enter your answer">`;
                    content += `<button id="submit-btn">Submit</button>`;
                }
                card.innerHTML = content;
                deck.appendChild(card);
                addEventListeners();
            }

            function addEventListeners() {
                const step = lessonData.steps[currentStep];
                 if (step.type === 'briefing') {
                    document.getElementById('next-btn').addEventListener('click', () => {
                        currentStep++;
                        renderStep();
                    });
                } else if (step.type === 'mcq' || step.type === 'scrambled-paragraph') {
                    document.querySelectorAll('.option').forEach(btn => {
                        btn.addEventListener('click', (e) => checkMCQAnswer(e.target));
                    });
                } else if (step.type === 'grid-in') {
                    document.getElementById('submit-btn').addEventListener('click', checkGridInAnswer);
                }
            }

            function checkMCQAnswer(selectedButton) {
                const step = lessonData.steps[currentStep];
                const isCorrect = selectedButton.textContent === step.correctAnswer;
                revealAnswer(isCorrect, step.explanation, selectedButton);
            }

            function checkGridInAnswer() {
                const step = lessonData.steps[currentStep];
                const answer = document.getElementById('grid-in-answer').value;
                const isCorrect = answer.trim().toLowerCase() === step.correctAnswer.toLowerCase();
                 revealAnswer(isCorrect, step.explanation);
            }

            function revealAnswer(isCorrect, explanation, selectedButton = null) {
                const step = lessonData.steps[currentStep];
                if (isCorrect) {
                    score += lessonData.pointsPerQuestion;
                    if (selectedButton) {
                        selectedButton.classList.add('correct');
                    } else {
                         document.getElementById('grid-in-answer').classList.add('correct');
                    }
                } else {
                    if (selectedButton) {
                        selectedButton.classList.add('incorrect');
                        // Highlight the correct answer
                        document.querySelectorAll('.option').forEach(btn => {
                            if (btn.textContent === step.correctAnswer) {
                                btn.classList.add('correct');
                            }
                        });
                    } else {
                        document.getElementById('grid-in-answer').classList.add('incorrect');
                    }
                }

                // Disable all inputs
                document.querySelectorAll('.option, #submit-btn, #grid-in-answer').forEach(el => el.disabled = true);

                // Show explanation
                const explanationEl = document.createElement('div');
                explanationEl.className = 'explanation';
                explanationEl.innerHTML = `<p>${explanation}</p><button id="next-btn">Next</button>`;
                deck.querySelector('.card').appendChild(explanationEl);

                // Add event listener to the new "Next" button
                document.getElementById('next-btn').addEventListener('click', () => {
                    currentStep++;
                    renderStep();
                });
            }

            function showResults() {
                deck.style.display = 'none';
                resultsScreen.style.display = 'block';
                const finalScore = score;
                const totalPossible = questionSteps.length * lessonData.pointsPerQuestion;

                resultsScreen.innerHTML = `
                    <h2>Mission Complete!</h2>
                    <p>Your Score: ${finalScore} / ${totalPossible}</p>
                    <p>You answered ${finalScore / lessonData.pointsPerQuestion} out of ${questionSteps.length} questions correctly.</p>
                    <button onclick="window.location.href='../index.html'">Return to Dashboard</button>
                `;
                
                // Mark lesson as complete
                localStorage.setItem(lessonId, 'completed');
            }

            init();
        });
    </script>
</body>
</html> 