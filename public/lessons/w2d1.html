<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>W2D1: Author's Craft & Advanced Fractions</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <div class="container">
        <header id="lesson-header"></header>
        <div id="lesson-deck"></div>
        <div id="results-screen" style="display: none;"></div>
    </div>

    <script>
        const lessonData = {
            title: "Mission: Author's Craft & Advanced Fractions",
            subtitle: "Week 2, Day 1",
            pointsPerQuestion: 10,
            completion_id: 'w2d1',
            steps: [
                {
                    type: 'briefing',
                    header: 'Briefing: Tone, Mood, and Complex Numbers',
                    content: `
                        <p>Welcome to Week 2. This week, we're digging deeper. In ELA, we'll analyze <strong>Author's Craft</strong>, starting with <strong>Tone</strong> (the author's attitude) and <strong>Mood</strong> (the feeling the reader gets). In Math, we'll tackle <strong>Advanced Fractions</strong>.</p>
                        <ul>
                            <li><strong>Tone vs. Mood:</strong> Tone is the author's feeling (e.g., cynical, sarcastic, optimistic). Mood is the atmosphere created for the reader (e.g., mysterious, cheerful, tense). Look at word choice and sentence structure for clues.</li>
                            <li><strong>Advanced Fractions:</strong> Expect complex fractions (fractions within fractions) and multi-step word problems involving fractions. Remember the fundamentals of finding common denominators and the 'keep, change, flip' rule for division.</li>
                        </ul>
                    `
                },
                // ELA Questions
                {
                    type: 'mcq',
                    header: 'ELA Question 1: Tone',
                    prompt: 'What is the tone of the speaker?',
                    passage: 'Oh, fantastic. Another meeting. I can hardly wait to sit for two hours and listen to Bob drone on about synergy. That\'s just how I wanted to spend my afternoon.',
                    options: ['Joyful and excited', 'Sarcastic and weary', 'Neutral and objective', 'Hopeful and optimistic'],
                    correctAnswer: 'Sarcastic and weary',
                    explanation: 'Phrases like "Oh, fantastic" and "I can hardly wait" are used sarcastically. The description of the meeting as listening to someone "drone on" indicates weariness.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Question 2: Mood',
                    prompt: 'What mood does the author create in this passage?',
                    passage: 'The wind howled through the skeletal branches of the trees. A floorboard creaked upstairs, but he knew he was alone in the house. A shadow danced in the corner of his eye, but when he turned, nothing was there. The only sound was the frantic beating of his own heart.',
                    options: ['Peaceful and calm', 'Joyful and celebratory', 'Tense and suspenseful', 'Humorous and light'],
                    correctAnswer: 'Tense and suspenseful',
                    explanation: 'The author uses words like "howled," "skeletal," and "frantic," along with classic suspense imagery (creaks, shadows, isolation), to create a mood of tension and fear in the reader.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Question 3: Tone',
                    prompt: 'What is the tone of this announcement?',
                    passage: 'It is with immense pleasure and pride that we announce the graduating class of 2024. These students have demonstrated remarkable resilience and intellectual curiosity. We look forward to seeing the incredible contributions they will make to the world.',
                    options: ['Sarcastic', 'Solemn and celebratory', 'Anxious', 'Confused'],
                    correctAnswer: 'Solemn and celebratory',
                    explanation: 'Words like "immense pleasure," "pride," and "remarkable resilience" create a tone that is both formal/serious (solemn) and happy (celebratory).'
                },
                {
                    type: 'mcq',
                    header: 'ELA Question 4: Mood',
                    prompt: 'What mood is created in this scene?',
                    passage: 'Sunlight streamed through the kitchen window, illuminating dust motes dancing in the air. The scent of freshly baked bread filled the room, and a cat purred contentedly on a nearby rug. Outside, children\'s laughter could be heard.',
                    options: ['Melancholy', 'Suspenseful', 'Content and peaceful', 'Hectic and chaotic'],
                    correctAnswer: 'Content and peaceful',
                    explanation: 'All the sensory details—warm sunlight, fresh bread, a purring cat, distant laughter—combine to create a mood of peace and contentment for the reader.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Question 5: Tone',
                    prompt: 'What is the likely tone of a scientist writing a paper on their research findings?',
                    passage: '',
                    options: ['Informal and chatty', 'Objective and analytical', 'Passionate and angry', 'Silly and humorous'],
                    correctAnswer: 'Objective and analytical',
                    explanation: 'Scientific writing prioritizes facts, evidence, and logical analysis. The tone is meant to be unbiased and objective.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Question 6: Mood',
                    prompt: 'Which of these details would contribute to a mysterious mood?',
                    options: [
                        'A locked door for which there is no key.',
                        'A brightly lit, crowded room.',
                        'A clear, sunny day.',
                        'A detailed, factual report.'
                    ],
                    correctAnswer: 'A locked door for which there is no key.',
                    explanation: 'The locked door creates a sense of the unknown and raises questions, which is the essence of a mysterious mood.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Question 7: Tone',
                    prompt: 'A politician says, "My esteemed opponent has some... interesting ideas." What is the likely tone?',
                    passage: '',
                    options: ['Genuinely complimentary', 'Condescending and dismissive', 'Confused and curious', 'Supportive and enthusiastic'],
                    correctAnswer: 'Condescending and dismissive',
                    explanation: 'The use of "esteemed" is likely ironic, and calling ideas "interesting" is often a polite way to dismiss them without attacking them directly.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Question 8: Mood',
                    prompt: 'A passage describes a surprise party, with confetti, loud music, and friends shouting "Surprise!" What is the mood?',
                    passage: '',
                    options: ['Tense', 'Somber', 'Festive and energetic', 'Calm'],
                    correctAnswer: 'Festive and energetic',
                    explanation: 'The details of a party—confetti, loud music, shouting—all contribute to a high-energy, celebratory (festive) mood.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Question 9: Tone',
                    prompt: 'What is the tone of a legal document or contract?',
                    passage: '',
                    options: ['Poetic', 'Vague and ambiguous', 'Precise and formal', 'Emotional'],
                    correctAnswer: 'Precise and formal',
                    explanation: 'Legal documents must be exact and unambiguous. The tone is highly formal and uses precise language to avoid misinterpretation.'
                },
                {
                    type: 'mcq',
                    header: 'ELA Question 10: Mood vs. Tone',
                    prompt: 'A writer may feel angry (tone) while describing a scene of injustice, but the reader might feel motivated to act (mood). This shows that:',
                    passage: '',
                    options: [
                        'Tone and mood are always the same.',
                        'Tone and mood can be different.',
                        'Tone is for the reader, and mood is for the author.',
                        'Good writing has no tone or mood.'
                    ],
                    correctAnswer: 'Tone and mood can be different.',
                    explanation: 'Tone is the author\'s attitude, while mood is the atmosphere created for the reader. They are related but can be distinct.'
                },
                // Math Questions
                {
                    type: 'grid-in',
                    header: 'Math Question 1: Complex Fractions',
                    prompt: 'Simplify the complex fraction: ( (2/3) + (1/6) ) / ( (3/4) - (1/2) )',
                    passage: 'Express your answer as a single fraction or whole number.',
                    correctAnswer: '10/3',
                    explanation: 'First, solve the numerator: (2/3) + (1/6) = (4/6) + (1/6) = 5/6. Then solve the denominator: (3/4) - (1/2) = (3/4) - (2/4) = 1/4. Finally, divide the two results: (5/6) / (1/4) = (5/6) * (4/1) = 20/6, which simplifies to 10/3.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Question 2: Fraction Word Problem',
                    prompt: 'A pizza is cut into 12 slices. Maria eats 1/4 of the pizza, and her brother eats 1/3 of the *remaining* slices. How many slices are left?',
                    correctAnswer: '6',
                    explanation: 'Maria eats 1/4 of 12, which is 3 slices. There are 12 - 3 = 9 slices remaining. Her brother eats 1/3 of the 9 remaining slices, which is 3 slices. The number of slices left is 9 - 3 = 6.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Question 3: Operations with Mixed Numbers',
                    prompt: 'Calculate: 3 1/2 + 2 1/4',
                    correctAnswer: '5 3/4',
                    explanation: 'Convert to improper fractions: 7/2 + 9/4. Find a common denominator: 14/4 + 9/4 = 23/4. Convert back to a mixed number: 5 3/4.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Question 4: Fraction of a Number',
                    prompt: 'A bookstore has 120 books. 2/5 are fiction and 1/3 are non-fiction. How many books are neither fiction nor non-fiction?',
                    correctAnswer: '32',
                    explanation: 'Fiction books: (2/5) * 120 = 48. Non-fiction books: (1/3) * 120 = 40. Total accounted for: 48 + 40 = 88. Remaining books: 120 - 88 = 32.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Question 5: Complex Fraction Division',
                    prompt: 'Simplify: ( 5 ) / ( 1/2 )',
                    correctAnswer: '10',
                    explanation: 'Dividing by a fraction is the same as multiplying by its reciprocal. 5 * (2/1) = 10.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Question 6: Subtracting Mixed Numbers',
                    prompt: 'Calculate: 5 1/6 - 2 2/3',
                    correctAnswer: '2 1/2',
                    explanation: 'Convert to improper fractions: 31/6 - 8/3. Common denominator: 31/6 - 16/6 = 15/6. Simplify: 5/2. Convert back: 2 1/2.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Question 7: Multiplying Fractions',
                    prompt: 'A recipe needs 3/4 cup of sugar. You are making only half the recipe. How much sugar do you need?',
                    correctAnswer: '3/8',
                    explanation: 'You need to calculate half of 3/4, which is (1/2) * (3/4) = 3/8.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Question 8: Word Problem with Fractions',
                    prompt: 'John spent 1/3 of his money on a game and 1/4 on a book. If he started with $60, how much money does he have left?',
                    correctAnswer: '25',
                    explanation: 'Game cost: (1/3)*60 = $20. Book cost: (1/4)*60 = $15. Total spent: $20 + $15 = $35. Money left: $60 - $35 = $25.'
                },
                {
                    type: 'mcq',
                    header: 'Math Question 9: Comparing Fractions',
                    prompt: 'Which fraction is larger, 5/8 or 7/12?',
                    options: ['5/8', '7/12', 'They are equal'],
                    correctAnswer: '5/8',
                    explanation: 'Find a common denominator, such as 24. 5/8 = 15/24. 7/12 = 14/24. 15/24 is larger than 14/24, so 5/8 is the larger fraction.'
                },
                {
                    type: 'grid-in',
                    header: 'Math Question 10: Complex Fraction with Variables',
                    prompt: 'If x=1/2, what is the value of (x + 1/x) / x ?',
                    correctAnswer: '5',
                    explanation: 'Substitute x=1/2. Numerator: (1/2 + 1/(1/2)) = (1/2 + 2) = 2.5. Denominator: 1/2. So, 2.5 / (1/2) = 5.'
                }
            ]
        };

        document.addEventListener('DOMContentLoaded', () => {
            const lessonHeader = document.getElementById('lesson-header');
            const lessonDeck = document.getElementById('lesson-deck');
            const resultsScreen = document.getElementById('results-screen');
            const completionId = lessonData.completion_id;

            let currentStep = 0;
            let score = 0;
            let completedAnswers = new Map();

            function startLesson() {
                lessonHeader.innerHTML = `<h1>${lessonData.title}</h1><p>${lessonData.subtitle}</p>`;
                showStep(currentStep);
            }

            function showStep(stepIndex) {
                const step = lessonData.steps[stepIndex];
                if (!step) {
                    showFinalResults();
                    return;
                }

                const card = document.createElement('div');
                card.className = 'card active';

                let content = `<div class="card-header"><h2>${step.header || ''}</h2></div>`;

                if (step.type === 'briefing') {
                    content += `<div class="card-content">${step.content}</div>`;
                    content += `<div class="card-actions"><button id="next-btn">Start Mission</button></div>`;
                } else {
                    const questionNumber = stepIndex;
                    const totalQuestions = lessonData.steps.filter(s => s.type !== 'briefing').length;
                    const progress = Math.round(((questionNumber) / totalQuestions) * 100);
                    
                    content += `<div class="progress-bar-container"><div class="progress-bar" style="width: ${progress}%"></div></div>`;
                    content += `<div class="card-content">`;
                    if (step.passage) {
                        content += `<p class="passage">${step.passage}</p>`;
                    }
                    content += `<p class="prompt">${step.prompt}</p>`;
                    
                    if (step.type === 'mcq') {
                        content += `<div class="options">`;
                        step.options.forEach((option) => {
                            content += `<button class="option-btn" data-answer="${option}">${option}</button>`;
                        });
                        content += `</div>`;
                    } else if (step.type === 'grid-in') {
                        content += `<div class="grid-in-container"><input type="text" id="grid-in-input" class="grid-in-input"><button id="submit-grid-in">Submit</button></div>`;
                    }
                }

                content += `<div class="feedback" style="display: none;"></div>`;
                card.innerHTML = content;
                lessonDeck.innerHTML = '';
                lessonDeck.appendChild(card);

                if (step.type === 'briefing') {
                    document.getElementById('next-btn').addEventListener('click', () => {
                        currentStep++;
                        showStep(currentStep);
                    });
                } else if (step.type === 'mcq') {
                    document.querySelectorAll('.option-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => handleAnswer(e.target.dataset.answer, step));
                    });
                } else if (step.type === 'grid-in') {
                    document.getElementById('submit-grid-in').addEventListener('click', () => {
                        const input = document.getElementById('grid-in-input').value;
                        handleAnswer(input, step);
                    });
                }
            }

            function handleAnswer(selectedAnswer, step) {
                const feedbackDiv = document.querySelector('.feedback');
                let isCorrect = selectedAnswer.trim().toLowerCase() === step.correctAnswer.trim().toLowerCase();
                
                if (isCorrect) {
                    score += lessonData.pointsPerQuestion;
                    feedbackDiv.innerHTML = `<p class="correct"><strong>Correct!</strong> ${step.explanation}</p>`;
                } else {
                    feedbackDiv.innerHTML = `<p class="incorrect"><strong>Incorrect.</strong> The correct answer is <strong>${step.correctAnswer}</strong>. ${step.explanation}</p>`;
                }
                
                completedAnswers.set(lessonData.steps.indexOf(step), selectedAnswer);
                feedbackDiv.style.display = 'block';

                document.querySelectorAll('.option-btn, #submit-grid-in').forEach(btn => btn.disabled = true);
                
                setTimeout(() => {
                    currentStep++;
                    showStep(currentStep);
                }, 3000); 
            }

            function showFinalResults() {
                lessonDeck.style.display = 'none';
                resultsScreen.style.display = 'block';
                const totalQuestions = lessonData.steps.filter(s => s.type !== 'briefing').length;
                const percentage = Math.round((score / (totalQuestions * lessonData.pointsPerQuestion)) * 100);

                resultsScreen.innerHTML = `
                    <div class="card active">
                        <div class="card-header"><h2>Mission Complete!</h2></div>
                        <div class="card-content">
                            <p>You scored ${score} out of ${totalQuestions * lessonData.pointsPerQuestion} (${percentage}%)</p>
                            <button id="restart-btn">Try Again</button>
                            <a href="/" class="button">Back to Dashboard</a>
                        </div>
                    </div>
                `;

                document.getElementById('restart-btn').addEventListener('click', () => {
                    currentStep = 0;
                    score = 0;
                    completedAnswers.clear();
                    resultsScreen.style.display = 'none';
                    lessonDeck.style.display = 'block';
                    startLesson();
                });

                // Mark lesson as complete
                let completedLessons = JSON.parse(localStorage.getItem('completedLessons')) || {};
                completedLessons[completionId] = { score: score, total: totalQuestions * lessonData.pointsPerQuestion };
                localStorage.setItem('completedLessons', JSON.stringify(completedLessons));
            }

            startLesson();
        });
    </script>
</body>
</html> 